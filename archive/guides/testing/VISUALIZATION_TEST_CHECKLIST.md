# 问卷2可视化全面测试清单

## 📋 测试环境
- **前端部署**: https://6fbd5b5e.college-employment-survey-frontend-l84.pages.dev/analytics/v3
- **后端API**: https://employment-survey-api-prod.chrismarker89.workers.dev
- **测试数据量**: 1000条

---

## ✅ 维度1：人口结构与就业画像

### 1.1 性别分布（饼图）
- [ ] 标签显示为中文（男、女、其他）
- [ ] 百分比正确显示（不显示undefined%）
- [ ] 数据总和为100%
- [ ] 图例正确显示

### 1.2 年龄分布（柱状图）
- [ ] 标签显示为中文（20岁以下、20-22岁、23-25岁等）
- [ ] 柱状图高度正确反映数据量
- [ ] X轴标签清晰可读
- [ ] 数据有值

### 1.3 学历分布（饼图）
- [ ] 标签显示为中文（高中、大专、本科、硕士、博士等）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

### 1.4 婚姻状况分布（饼图）
- [ ] 标签显示为中文（未婚、已婚、离异、丧偶）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

### 1.5 城市层级分布（柱状图）
- [ ] 标签显示为中文（一线城市、二线城市、三线城市、四线及以下）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

### 1.6 户籍类型分布（饼图）
- [ ] 标签显示为中文（城镇、农村）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

---

## ✅ 维度2：经济压力与生活成本

### 2.1 负债情况分布（柱状图）
- [ ] 标签显示为中文（无负债、助学贷款、房贷、车贷、消费贷等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰（可能需要旋转）
- [ ] 数据有值

### 2.2 每月生活开支分布（柱状图）
- [ ] 标签显示为中文（1000元以下、1000-2000元等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

### 2.3 收入来源分布（柱状图）
- [ ] 标签显示为中文（工资收入、自由职业收入、父母支持等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] **数据有值（之前为空，现已修复）**

### 2.4 父母支援金额分布（柱状图）
- [ ] 标签显示为中文（无支援、500元以下、500-1000元等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] **数据有值（之前为空，现已修复）**

### 2.5 收支平衡状况（饼图）
- [ ] 标签显示为中文（大量结余、略有结余、收支平衡等）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

### 2.6 经济压力程度（饼图）
- [ ] 标签显示为中文（无压力、压力较小、压力适中等）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

---

## ✅ 维度3：就业状态与收入水平

### 3.1 就业状态分布（饼图）
- [ ] 标签显示为中文（在职、失业、在校学生、自由职业）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

### 3.2 月薪分布（柱状图）
- [ ] 标签显示为中文（3000元以下、3000-5000元等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

---

## ✅ 维度4：求职歧视与公平性

### 4.1 歧视类型分布（柱状图）
- [ ] 标签显示为中文（无歧视、年龄歧视、性别歧视、学历歧视等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

### 4.2 歧视严重程度（饼图）
- [ ] 标签显示为中文（轻微、中等、严重）
- [ ] 百分比正确显示
- [ ] 数据总和为100%
- [ ] 图例正确显示

### 4.3 歧视发生渠道（柱状图）
- [ ] 标签显示为中文（招聘信息、面试过程、Offer阶段、职场环境）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

---

## ✅ 维度5：就业信心与未来预期

### 5.1 就业信心指数分布（柱状图）
- [ ] 标签显示为中文（非常不自信、不太自信、一般、比较自信、非常自信）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

### 5.2 信心影响因素（柱状图）
- [ ] 标签显示为中文（市场前景、个人技能、教育背景、工作经验等）
- [ ] 柱状图高度正确
- [ ] X轴标签清晰
- [ ] 数据有值

---

## ✅ 维度6：生育意愿与婚育压力

### 6.1 生育计划分布（饼图）
- [ ] 标签显示为中文（不打算生育、观望中、计划生1个等）
- [ ] 百分比正确显示（如果有数据）
- [ ] 数据总和为100%（如果有数据）
- [ ] **注意：测试数据中可能没有此字段，图表可能为空**

---

## 🔧 已修复的问题

### 1. 标签中英文映射
- ✅ 创建了完整的 `labelMappings.ts` 配置文件
- ✅ 包含所有维度的中英文映射
- ✅ 数据服务自动应用翻译

### 2. 百分比显示问题
- ✅ 修复了页面传递数据时丢失 `percentage` 字段的问题
- ✅ 所有图表现在直接传递完整数据对象（包含 name, value, percentage）
- ✅ 修复了图表组件的 label 显示逻辑，正确处理 undefined 情况

### 3. 缺失数据字段
- ✅ 后端添加了"收入来源"统计
- ✅ 后端添加了"父母支援金额"统计
- ✅ 后端添加了"收支平衡"统计
- ✅ 后端添加了"生育意愿"统计（但测试数据中可能没有）

---

## 📊 数据验证命令

### 检查后端API返回的数据结构
```bash
# 检查性别数据
curl -s https://employment-survey-api-prod.chrismarker89.workers.dev/api/universal-questionnaire/statistics/questionnaire-v2-2024 | jq '.data.demographics.gender.data'

# 检查收入来源数据
curl -s https://employment-survey-api-prod.chrismarker89.workers.dev/api/universal-questionnaire/statistics/questionnaire-v2-2024 | jq '.data.economic.incomeSources.data'

# 检查父母支援数据
curl -s https://employment-survey-api-prod.chrismarker89.workers.dev/api/universal-questionnaire/statistics/questionnaire-v2-2024 | jq '.data.economic.parentalSupport.data'

# 检查生育意愿数据
curl -s https://employment-survey-api-prod.chrismarker89.workers.dev/api/universal-questionnaire/statistics/questionnaire-v2-2024 | jq '.data.fertility.intent.data'
```

---

## 🚨 已知问题

### 1. 生育意愿图表为空
- **原因**: 测试数据生成脚本中没有包含 `fertility-plan-v2` 字段
- **影响**: 生育意愿图表显示为空
- **解决方案**: 更新测试数据生成脚本，重新生成1000条数据

### 2. 部分标签可能需要优化
- **建议**: 根据实际使用反馈调整标签文案
- **示例**: "信心指数 1" 可能需要改为更友好的描述

---

## 📝 测试步骤

1. **打开页面**: https://6fbd5b5e.college-employment-survey-frontend-l84.pages.dev/analytics/v3
2. **逐个Tab检查**: 按照上述清单逐个维度检查
3. **记录问题**: 如发现任何标签显示为英文或undefined%，记录具体位置
4. **验证数据**: 使用上述命令验证后端API返回的数据
5. **截图存档**: 对所有图表截图，便于后续对比

---

## ✨ 预期结果

- ✅ 所有标签显示为中文
- ✅ 所有百分比正确显示（不显示undefined%）
- ✅ 所有图表有数据（除生育意愿外）
- ✅ 图表交互正常（hover显示tooltip）
- ✅ 移动端响应式正常

---

## 🔄 后续优化建议

1. **增加测试数据量**: 从1000条增加到5000条，确保所有字段都有足够样本
2. **添加生育意愿数据**: 更新测试数据生成脚本
3. **优化标签文案**: 根据用户反馈调整
4. **添加数据导出功能**: 支持导出图表数据为Excel
5. **添加数据筛选功能**: 支持按时间范围、地区等筛选

