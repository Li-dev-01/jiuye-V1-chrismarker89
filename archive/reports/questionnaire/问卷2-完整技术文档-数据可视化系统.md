# é—®å·2 - å®Œæ•´æŠ€æœ¯æ–‡æ¡£ï¼šæ•°æ®å¯è§†åŒ–ç³»ç»Ÿ

## ğŸ“‹ æ–‡æ¡£æ¦‚è§ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-01-05  
**ç³»ç»Ÿåç§°**: é—®å·2ä¸ƒç»´åº¦æ•°æ®å¯è§†åŒ–ç³»ç»Ÿ  
**æŠ€æœ¯æ ˆ**: React + TypeScript + Ant Design + ECharts + Cloudflare Workers/Pages/D1

---

## ç›®å½•

1. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
2. [æ•°æ®ç»“æ„](#æ•°æ®ç»“æ„)
3. [APIæ¥å£](#apiæ¥å£)
4. [å‰ç«¯ç»„ä»¶](#å‰ç«¯ç»„ä»¶)
5. [æ•°æ®æµç¨‹](#æ•°æ®æµç¨‹)
6. [å®šæ—¶ä»»åŠ¡](#å®šæ—¶ä»»åŠ¡)
7. [éƒ¨ç½²é…ç½®](#éƒ¨ç½²é…ç½®)
8. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·æµè§ˆå™¨                            â”‚
â”‚  https://college-employment-survey-frontend-l84.pages.dev   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTTPS
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare Pages                          â”‚
â”‚                   (å‰ç«¯é™æ€èµ„æº)                              â”‚
â”‚  - React SPA                                                 â”‚
â”‚  - Ant Design UI                                             â”‚
â”‚  - ECharts å›¾è¡¨                                              â”‚
â”‚  - ä¸ƒç»´åº¦å¯è§†åŒ–é¡µé¢                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ APIè°ƒç”¨
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Cloudflare Workers                          â”‚
â”‚     https://employment-survey-api-prod.workers.dev           â”‚
â”‚  - Honoæ¡†æ¶                                                  â”‚
â”‚  - TypeScript                                                â”‚
â”‚  - APIè·¯ç”±                                                   â”‚
â”‚  - æ•°æ®å¤„ç†                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ SQLæŸ¥è¯¢
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare D1                             â”‚
â”‚              (SQLiteæ•°æ®åº“)                                  â”‚
â”‚  - universal_questionnaire_responses (åŸå§‹æ•°æ®)              â”‚
â”‚  - q2_basic_stats (åŸºç¡€ç»Ÿè®¡)                                 â”‚
â”‚  - q2_economic_analysis (ç»æµåˆ†æ)                           â”‚
â”‚  - q2_employment_analysis (å°±ä¸šåˆ†æ)                         â”‚
â”‚  - q2_discrimination_analysis (æ­§è§†åˆ†æ)                     â”‚
â”‚  - q2_confidence_analysis (ä¿¡å¿ƒåˆ†æ)                         â”‚
â”‚  - q2_fertility_analysis (ç”Ÿè‚²åˆ†æ)                          â”‚
â”‚  - q2_sync_log (åŒæ­¥æ—¥å¿—)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–²
                     â”‚
                     â”‚ å®šæ—¶åŒæ­¥ (æ¯30åˆ†é’Ÿ)
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Cloudflare Workers Cron                         â”‚
â”‚  - scheduled handler                                         â”‚
â”‚  - questionnaire2SyncHandler                                 â”‚
â”‚  - è‡ªåŠ¨æ•°æ®åŒæ­¥                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯¦æƒ…

#### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: React 18.3.1
- **è¯­è¨€**: TypeScript 5.x
- **UIåº“**: Ant Design 5.26.6
- **å›¾è¡¨åº“**: ECharts 5.6.0 (via echarts-for-react)
- **è·¯ç”±**: React Router 6.30.1
- **åŠ¨ç”»**: Framer Motion 11.x
- **æ„å»ºå·¥å…·**: Vite 5.4.19
- **éƒ¨ç½²å¹³å°**: Cloudflare Pages

#### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Hono 4.x
- **è¯­è¨€**: TypeScript 5.x
- **è¿è¡Œæ—¶**: Cloudflare Workers
- **æ•°æ®åº“**: Cloudflare D1 (SQLite)
- **å®šæ—¶ä»»åŠ¡**: Cloudflare Workers Cron
- **éƒ¨ç½²å·¥å…·**: Wrangler 4.x

---

## æ•°æ®ç»“æ„

### 1. åŸå§‹æ•°æ®è¡¨ï¼šuniversal_questionnaire_responses

**è¡¨å**: `universal_questionnaire_responses`

**ç”¨é€”**: å­˜å‚¨æ‰€æœ‰é—®å·çš„åŸå§‹å“åº”æ•°æ®

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE universal_questionnaire_responses (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  questionnaire_id VARCHAR(100) NOT NULL,     -- é—®å·ID: 'questionnaire-v2-2024'
  user_id VARCHAR(100),                       -- ç”¨æˆ·ID (å¯é€‰)
  response_data TEXT NOT NULL,                -- JSONæ ¼å¼çš„å“åº”æ•°æ®
  submitted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  ip_address VARCHAR(45),
  user_agent TEXT,
  FOREIGN KEY (questionnaire_id) REFERENCES universal_questionnaires(id)
);
```

**response_data JSONç»“æ„**:
```typescript
{
  sectionResponses: [
    {
      sectionId: 'basic-demographics-v2',
      responses: [
        { questionId: 'gender-v2', value: 'male' },
        { questionId: 'age-range-v2', value: '23-25' },
        { questionId: 'education-level-v2', value: 'bachelor' },
        { questionId: 'marital-status-v2', value: 'single' },
        { questionId: 'current-city-tier-v2', value: 'tier-1' },
        { questionId: 'hukou-type-v2', value: 'urban' },
        { questionId: 'current-province-v2', value: 'beijing' },
        { questionId: 'hometown-province-v2', value: 'shandong' }
      ]
    },
    {
      sectionId: 'current-status-v2',
      responses: [
        { questionId: 'current-status-question-v2', value: 'employed' }
      ]
    },
    {
      sectionId: 'universal-economic-pressure-v2',
      responses: [
        { questionId: 'debt-situation-v2', value: 'student-loan' },
        { questionId: 'monthly-living-cost-v2', value: '3000-5000' },
        { questionId: 'income-sources-v2', value: ['salary', 'parental-support'] },
        { questionId: 'parental-support-amount-v2', value: '1000-2000' },
        { questionId: 'income-expense-balance-v2', value: 'balanced' },
        { questionId: 'economic-pressure-level-v2', value: 'moderate' },
        { questionId: 'economic-pressure-sources-v2', value: ['housing', 'daily-expenses'] }
      ]
    },
    {
      sectionId: 'employment-confidence-v2',
      responses: [
        { questionId: 'employment-confidence-v2', value: '3' },
        { questionId: 'confidence-factors-v2', value: ['market-competition', 'skill-mismatch'] }
      ]
    },
    {
      sectionId: 'discrimination-experience-v2',
      responses: [
        { questionId: 'experienced-discrimination-types-v2', value: ['age', 'education'] },
        { questionId: 'discrimination-severity-v2', value: 'moderate' },
        { questionId: 'discrimination-channels-v2', value: ['job-posting', 'interview'] }
      ]
    },
    // ... å…¶ä»–æ¡ä»¶åˆ†æ”¯section
  ],
  metadata: {
    submittedAt: 1704441600000,
    isTestData: true,
    testDataRole: 'young_professional'
  }
}
```

**æ•°æ®é‡**: 1010æ¡ (æˆªè‡³2025-01-05)

---

### 2. é™æ€ç»Ÿè®¡è¡¨

#### 2.1 åŸºç¡€ç»Ÿè®¡è¡¨ï¼šq2_basic_stats

**ç”¨é€”**: æ”¯æŒç»´åº¦1ï¼ˆäººå£ç»“æ„ä¸å°±ä¸šç”»åƒï¼‰

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_basic_stats (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  dimension VARCHAR(50) NOT NULL,      -- ç»´åº¦åç§°
  value VARCHAR(100) NOT NULL,         -- ç»´åº¦å€¼
  count INTEGER NOT NULL DEFAULT 0,    -- æ•°é‡
  percentage DECIMAL(5,2),             -- ç™¾åˆ†æ¯”
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ç»´åº¦åˆ—è¡¨**:
- `gender`: æ€§åˆ« (male, female, other)
- `age_range`: å¹´é¾„æ®µ (20-22, 23-25, 26-28, 29-35, over-35)
- `education_level`: å­¦å† (high-school, associate, bachelor, master, phd)
- `marital_status`: å©šå§»çŠ¶å†µ (single, married, divorced)
- `city_tier`: åŸå¸‚å±‚çº§ (tier-1, tier-2, tier-3, tier-4)
- `hukou_type`: æˆ·ç±ç±»å‹ (urban, rural)

**ç¤ºä¾‹æ•°æ®**:
```
| dimension       | value      | count | percentage |
|-----------------|------------|-------|------------|
| gender          | male       | 520   | 51.49      |
| gender          | female     | 450   | 44.55      |
| age_range       | 23-25      | 300   | 29.70      |
| education_level | bachelor   | 450   | 44.55      |
```

#### 2.2 ç»æµåˆ†æè¡¨ï¼šq2_economic_analysis

**ç”¨é€”**: æ”¯æŒç»´åº¦2ï¼ˆç»æµå‹åŠ›ä¸ç”Ÿæ´»æˆæœ¬ï¼‰

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_economic_analysis (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  age_range VARCHAR(20),
  employment_status VARCHAR(50),
  avg_living_cost DECIMAL(10,2),
  avg_debt_burden DECIMAL(10,2),
  parental_support_rate DECIMAL(5,2),
  high_pressure_rate DECIMAL(5,2),
  income_deficit_rate DECIMAL(5,2),
  count INTEGER NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2.3 å°±ä¸šåˆ†æè¡¨ï¼šq2_employment_analysis

**ç”¨é€”**: æ”¯æŒç»´åº¦3ï¼ˆå°±ä¸šçŠ¶æ€ä¸æ”¶å…¥æ°´å¹³ï¼‰

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_employment_analysis (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  age_range VARCHAR(20),
  education_level VARCHAR(50),
  city_tier VARCHAR(20),
  employment_status VARCHAR(50),
  avg_salary DECIMAL(10,2),
  unemployment_rate DECIMAL(5,2),
  avg_job_search_months DECIMAL(5,2),
  salary_debt_ratio_high_rate DECIMAL(5,2),
  count INTEGER NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2.4 æ­§è§†åˆ†æè¡¨ï¼šq2_discrimination_analysis

**ç”¨é€”**: æ”¯æŒç»´åº¦4ï¼ˆæ±‚èŒæ­§è§†ä¸å…¬å¹³æ€§ï¼‰

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_discrimination_analysis (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  discrimination_type VARCHAR(50),
  gender VARCHAR(20),
  age_range VARCHAR(20),
  severity VARCHAR(20),
  channel VARCHAR(50),
  count INTEGER NOT NULL DEFAULT 0,
  percentage DECIMAL(5,2),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2.5 ä¿¡å¿ƒåˆ†æè¡¨ï¼šq2_confidence_analysis

**ç”¨é€”**: æ”¯æŒç»´åº¦5ï¼ˆå°±ä¸šä¿¡å¿ƒä¸æœªæ¥é¢„æœŸï¼‰

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_confidence_analysis (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  confidence_level VARCHAR(20),
  age_range VARCHAR(20),
  employment_status VARCHAR(50),
  avg_confidence_score DECIMAL(3,2),
  count INTEGER NOT NULL DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2.6 ç”Ÿè‚²åˆ†æè¡¨ï¼šq2_fertility_analysis

**ç”¨é€”**: æ”¯æŒç»´åº¦6ï¼ˆç”Ÿè‚²æ„æ„¿ä¸å©šè‚²å‹åŠ›ï¼‰

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_fertility_analysis (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  fertility_intent VARCHAR(50),
  gender VARCHAR(20),
  age_range VARCHAR(20),
  marital_status VARCHAR(20),
  economic_pressure_level VARCHAR(20),
  count INTEGER NOT NULL DEFAULT 0,
  percentage DECIMAL(5,2),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2.7 åŒæ­¥æ—¥å¿—è¡¨ï¼šq2_sync_log

**ç”¨é€”**: è®°å½•æ•°æ®åŒæ­¥å†å²

**å­—æ®µç»“æ„**:
```sql
CREATE TABLE q2_sync_log (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  sync_type VARCHAR(50),           -- åŒæ­¥ç±»å‹: 'manual', 'scheduled'
  tables_synced INTEGER,            -- åŒæ­¥çš„è¡¨æ•°é‡
  records_processed INTEGER,        -- å¤„ç†çš„è®°å½•æ•°
  status VARCHAR(20),               -- çŠ¶æ€: 'success', 'failed'
  error_message TEXT,               -- é”™è¯¯ä¿¡æ¯
  sync_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## APIæ¥å£

### åŸºç¡€URL

**ç”Ÿäº§ç¯å¢ƒ**: `https://employment-survey-api-prod.chrismarker89.workers.dev`

### æ¥å£åˆ—è¡¨

#### 1. è·å–é—®å·2ç»Ÿè®¡æ•°æ®

**ç«¯ç‚¹**: `GET /api/universal-questionnaire/questionnaires/questionnaire-v2-2024/statistics`

**ç”¨é€”**: è·å–é—®å·2çš„å®Œæ•´ç»Ÿè®¡æ•°æ®ï¼ˆç”¨äºå‰ç«¯å¯è§†åŒ–ï¼‰

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl https://employment-survey-api-prod.chrismarker89.workers.dev/api/universal-questionnaire/questionnaires/questionnaire-v2-2024/statistics
```

**å“åº”æ ¼å¼**:
```typescript
{
  success: boolean;
  data: {
    totalResponses: number;
    responses: Array<{
      id: number;
      questionnaire_id: string;
      user_id: string | null;
      response_data: string;  // JSONå­—ç¬¦ä¸²
      submitted_at: string;
      ip_address: string | null;
      user_agent: string | null;
    }>;
  };
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "totalResponses": 1010,
    "responses": [
      {
        "id": 1,
        "questionnaire_id": "questionnaire-v2-2024",
        "user_id": null,
        "response_data": "{\"sectionResponses\":[...],\"metadata\":{...}}",
        "submitted_at": "2025-01-05T10:00:00.000Z",
        "ip_address": "127.0.0.1",
        "user_agent": "Mozilla/5.0..."
      }
      // ... æ›´å¤šè®°å½•
    ]
  }
}
```

#### 2. æ‰‹åŠ¨è§¦å‘å®Œæ•´åŒæ­¥

**ç«¯ç‚¹**: `POST /api/questionnaire-v2/sync-full`

**ç”¨é€”**: æ‰‹åŠ¨è§¦å‘æ•°æ®åŒæ­¥åˆ°é™æ€è¡¨ï¼ˆç”¨äºæµ‹è¯•å’Œç´§æ€¥åŒæ­¥ï¼‰

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST https://employment-survey-api-prod.chrismarker89.workers.dev/api/questionnaire-v2/sync-full \
  -H "Content-Type: application/json"
```

**å“åº”æ ¼å¼**:
```typescript
{
  success: boolean;
  message: string;
  syncedTables: string[];
  totalRecords: number;
  errors: string[];
  timestamp: number;
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "message": "å®Œæ•´åŒæ­¥å®Œæˆ",
  "syncedTables": [
    "q2_basic_stats",
    "q2_economic_analysis",
    "q2_employment_analysis",
    "q2_discrimination_analysis",
    "q2_confidence_analysis",
    "q2_fertility_analysis"
  ],
  "totalRecords": 1010,
  "errors": [],
  "timestamp": 1704441600000
}
```

---

## å‰ç«¯ç»„ä»¶

### 1. æ ¸å¿ƒé¡µé¢ç»„ä»¶

#### Questionnaire2SevenDimensionPage

**æ–‡ä»¶è·¯å¾„**: `frontend/src/pages/Questionnaire2SevenDimensionPage.tsx`

**ç”¨é€”**: ä¸ƒç»´åº¦å¯è§†åŒ–ä¸»é¡µé¢

**è·¯ç”±**: `/analytics/v3`

**ç»„ä»¶ç»“æ„**:
```typescript
const Questionnaire2SevenDimensionPage: React.FC = () => {
  // çŠ¶æ€ç®¡ç†
  const [state, setState] = useState<PageState>({
    loading: true,
    error: null,
    activeTab: 'demographics',
    statistics: null
  });

  // æ•°æ®åŠ è½½
  useEffect(() => {
    loadData();
  }, []);

  // æ¸²æŸ“7ä¸ªç»´åº¦
  return (
    <div className="questionnaire2-seven-dimension-page">
      {/* æ¦‚è¿°å¡ç‰‡ */}
      <Card>
        <Statistic title="æ€»å‚ä¸äººæ•°" value={statistics.totalResponses} />
        {/* ... æ›´å¤šç»Ÿè®¡ */}
      </Card>

      {/* 7ä¸ªTab */}
      <Tabs activeKey={state.activeTab} onChange={handleTabChange}>
        <TabPane tab="äººå£ç»“æ„" key="demographics">
          {renderDemographicsContent()}
        </TabPane>
        <TabPane tab="ç»æµå‹åŠ›" key="economic">
          {renderEconomicContent()}
        </TabPane>
        {/* ... å…¶ä»–5ä¸ªTab */}
      </Tabs>
    </div>
  );
};
```

**Props**: æ— 

**State**:
```typescript
interface PageState {
  loading: boolean;
  error: string | null;
  activeTab: string;
  statistics: Questionnaire2Statistics | null;
}
```

---

### 2. æ•°æ®æœåŠ¡

#### questionnaire2DataService

**æ–‡ä»¶è·¯å¾„**: `frontend/src/services/questionnaire2DataService.ts`

**ç”¨é€”**: é—®å·2æ•°æ®åŠ è½½å’Œå¤„ç†æœåŠ¡

**æ ¸å¿ƒæ–¹æ³•**:

##### getStatistics()

**åŠŸèƒ½**: è·å–é—®å·2ç»Ÿè®¡æ•°æ®

**è¿”å›ç±»å‹**: `Promise<Questionnaire2Statistics>`

**å®ç°é€»è¾‘**:
```typescript
async getStatistics(): Promise<Questionnaire2Statistics> {
  // 1. æ£€æŸ¥ç¼“å­˜
  if (this.cache && Date.now() - this.cacheTime < this.cacheTTL) {
    return this.cache;
  }

  try {
    // 2. ä»APIåŠ è½½
    const response = await fetch(`${API_URL}/statistics`);
    const data = await response.json();

    // 3. å¤„ç†æ•°æ®
    const statistics = this.processRawData(data);

    // 4. ç¼“å­˜æ•°æ®
    this.cache = statistics;
    this.cacheTime = Date.now();

    return statistics;
  } catch (error) {
    // 5. é”™è¯¯å¤„ç†
    if (this.cache) {
      return this.cache;  // è¿”å›ç¼“å­˜
    }
    throw new Error('æ— æ³•åŠ è½½æ•°æ®');  // çº¿ä¸Šç¯å¢ƒç¦ç”¨æ¨¡æ‹Ÿæ•°æ®
  }
}
```

**ç¼“å­˜ç­–ç•¥**:
- TTL: 5åˆ†é’Ÿ
- ç¼“å­˜é”®: å†…å­˜ç¼“å­˜
- å¤±æ•ˆç­–ç•¥: æ—¶é—´è¿‡æœŸæˆ–æ‰‹åŠ¨åˆ·æ–°

##### processRawData()

**åŠŸèƒ½**: å¤„ç†åŸå§‹APIæ•°æ®ï¼Œç”Ÿæˆç»Ÿè®¡

**å‚æ•°**: `rawData: any`

**è¿”å›**: `Questionnaire2Statistics`

**å®ç°é€»è¾‘**:
```typescript
private processRawData(rawData: any): Questionnaire2Statistics {
  const responses = rawData.data.responses;
  const stats = this.initializeStats();

  // éå†æ‰€æœ‰å“åº”
  for (const response of responses) {
    const data = JSON.parse(response.response_data);
    const sectionResponses = data.sectionResponses;

    // æå–å„ä¸ªé—®é¢˜çš„ç­”æ¡ˆ
    for (const section of sectionResponses) {
      for (const questionResponse of section.responses) {
        const questionId = questionResponse.questionId;
        const value = questionResponse.value;

        // ç»Ÿè®¡èšåˆ
        this.aggregateStats(stats, questionId, value);
      }
    }
  }

  // è®¡ç®—ç™¾åˆ†æ¯”
  this.calculatePercentages(stats, responses.length);

  return stats;
}
```

---

### 3. æ•°æ®ç±»å‹å®šä¹‰

#### Questionnaire2Statistics

**æ–‡ä»¶è·¯å¾„**: `frontend/src/services/questionnaire2DataService.ts`

**ç±»å‹å®šä¹‰**:
```typescript
export interface Questionnaire2Statistics {
  totalResponses: number;
  lastUpdated: string;
  demographics: {
    gender: DimensionStatistics;
    ageRange: DimensionStatistics;
    educationLevel: DimensionStatistics;
    maritalStatus: DimensionStatistics;
    cityTier: DimensionStatistics;
    hukouType: DimensionStatistics;
    employmentStatus: DimensionStatistics;
  };
  economic: {
    debtSituation: DimensionStatistics;
    monthlyLivingCost: DimensionStatistics;
    incomeSources: DimensionStatistics;
    parentalSupportAmount: DimensionStatistics;
    incomeExpenseBalance: DimensionStatistics;
    economicPressureLevel: DimensionStatistics;
  };
  employment: {
    employmentStatus: DimensionStatistics;
    currentSalary: DimensionStatistics;
  };
  discrimination: {
    discriminationTypes: DimensionStatistics;
    discriminationSeverity: DimensionStatistics;
    discriminationChannels: DimensionStatistics;
  };
  confidence: {
    employmentConfidence: DimensionStatistics;
    confidenceFactors: DimensionStatistics;
  };
  fertility: {
    fertilityIntent: DimensionStatistics;
  };
}

export interface DimensionStatistics {
  total: number;
  data: Array<{
    name: string;
    value: number;
    percentage: number;
  }>;
}
```

---

## æ•°æ®æµç¨‹

### å®Œæ•´æ•°æ®æµç¨‹å›¾

```
ç”¨æˆ·å¡«å†™é—®å·
    â†“
æäº¤åˆ°API
    â†“
å­˜å‚¨åˆ° universal_questionnaire_responses
    â†“
å®šæ—¶ä»»åŠ¡è§¦å‘ (æ¯30åˆ†é’Ÿ)
    â†“
questionnaire2SyncHandler è¯»å–åŸå§‹æ•°æ®
    â†“
è§£æ JSON response_data
    â†“
ç»Ÿè®¡èšåˆ
    â†“
å†™å…¥é™æ€è¡¨ (q2_basic_statsç­‰)
    â†“
å‰ç«¯è®¿é—® /analytics/v3
    â†“
questionnaire2DataService è°ƒç”¨API
    â†“
APIè¿”å›åŸå§‹æ•°æ®
    â†“
å‰ç«¯è§£æå¹¶ç”Ÿæˆç»Ÿè®¡
    â†“
ç¼“å­˜5åˆ†é’Ÿ
    â†“
æ¸²æŸ“å›¾è¡¨
```

### æ•°æ®å¤„ç†æµç¨‹è¯¦è§£

#### 1. æ•°æ®é‡‡é›†é˜¶æ®µ

**è§¦å‘**: ç”¨æˆ·æäº¤é—®å·

**æµç¨‹**:
1. ç”¨æˆ·åœ¨å‰ç«¯å¡«å†™é—®å·
2. å‰ç«¯éªŒè¯æ•°æ®å®Œæ•´æ€§
3. è°ƒç”¨APIæäº¤æ•°æ®
4. åç«¯éªŒè¯å¹¶å­˜å‚¨åˆ°`universal_questionnaire_responses`è¡¨
5. è¿”å›æˆåŠŸå“åº”

**æ•°æ®æ ¼å¼**: JSON (è§æ•°æ®ç»“æ„ç« èŠ‚)

#### 2. æ•°æ®åŒæ­¥é˜¶æ®µ

**è§¦å‘**: å®šæ—¶ä»»åŠ¡ (æ¯30åˆ†é’Ÿ) æˆ–æ‰‹åŠ¨è§¦å‘

**æµç¨‹**:
1. Cloudflare Workers Cronè§¦å‘scheduled handler
2. è°ƒç”¨`questionnaire2SyncHandler.executeFullSync()`
3. ä»`universal_questionnaire_responses`è¯»å–æ‰€æœ‰é—®å·2æ•°æ®
4. è§£ææ¯æ¡è®°å½•çš„`response_data` JSON
5. ç»Ÿè®¡èšåˆå„ä¸ªç»´åº¦çš„æ•°æ®
6. æ¸…ç©ºé™æ€è¡¨
7. æ‰¹é‡æ’å…¥æ–°ç»Ÿè®¡æ•°æ®
8. è®°å½•åŒæ­¥æ—¥å¿—åˆ°`q2_sync_log`

**ä»£ç ç¤ºä¾‹**:
```typescript
// backend/src/handlers/questionnaire2SyncHandler.ts
async executeFullSync() {
  // 1. è¯»å–åŸå§‹æ•°æ®
  const responses = await this.db
    .prepare('SELECT response_data FROM universal_questionnaire_responses WHERE questionnaire_id = ?')
    .bind('questionnaire-v2-2024')
    .all();

  // 2. è§£æå¹¶ç»Ÿè®¡
  const stats = this.parseResponses(responses.results);

  // 3. åŒæ­¥åˆ°å„ä¸ªé™æ€è¡¨
  await this.syncBasicStats(stats);
  await this.syncEconomicAnalysis(stats);
  // ... å…¶ä»–è¡¨

  // 4. è®°å½•æ—¥å¿—
  await this.logSync(6, responses.results.length);
}
```

#### 3. æ•°æ®å±•ç¤ºé˜¶æ®µ

**è§¦å‘**: ç”¨æˆ·è®¿é—®`/analytics/v3`

**æµç¨‹**:
1. é¡µé¢åŠ è½½ï¼Œæ˜¾ç¤ºLoadingçŠ¶æ€
2. `questionnaire2DataService.getStatistics()`è¢«è°ƒç”¨
3. æ£€æŸ¥ç¼“å­˜ï¼Œå¦‚æœæœ‰æ•ˆåˆ™ç›´æ¥è¿”å›
4. å¦‚æœç¼“å­˜å¤±æ•ˆï¼Œè°ƒç”¨APIè·å–åŸå§‹æ•°æ®
5. å‰ç«¯è§£æJSONå¹¶ç”Ÿæˆç»Ÿè®¡
6. ç¼“å­˜ç»Ÿè®¡ç»“æœï¼ˆ5åˆ†é’ŸTTLï¼‰
7. æ¸²æŸ“7ä¸ªç»´åº¦çš„å›¾è¡¨

**ä»£ç ç¤ºä¾‹**:
```typescript
// frontend/src/services/questionnaire2DataService.ts
async getStatistics() {
  // æ£€æŸ¥ç¼“å­˜
  if (this.cache && Date.now() - this.cacheTime < this.cacheTTL) {
    return this.cache;
  }

  // è°ƒç”¨API
  const response = await fetch(`${API_URL}/statistics`);
  const data = await response.json();

  // å¤„ç†æ•°æ®
  const statistics = this.processRawData(data);

  // ç¼“å­˜
  this.cache = statistics;
  this.cacheTime = Date.now();

  return statistics;
}
```

---

## å®šæ—¶ä»»åŠ¡

### Croné…ç½®

**æ–‡ä»¶**: `backend/wrangler.toml`

**é…ç½®**:
```toml
[triggers]
crons = [
  "*/30 * * * *"    # æ¯30åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
]
```

**Cronè¡¨è¾¾å¼è¯´æ˜**:
- `*/30`: æ¯30åˆ†é’Ÿ
- `*`: æ¯å°æ—¶
- `*`: æ¯å¤©
- `*`: æ¯æœˆ
- `*`: æ¯å‘¨

### Scheduled Handler

**æ–‡ä»¶**: `backend/src/index.ts`

**å®ç°**:
```typescript
export default {
  fetch: app.fetch,

  async scheduled(event: CronEvent, env: Env, ctx: ExecutionContext) {
    console.log('ğŸ• å®šæ—¶ä»»åŠ¡è§¦å‘:', event.cron);
    
    try {
      await handleScheduledSync(event, env);
      console.log('âœ… å®šæ—¶ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ');
    } catch (error) {
      console.error('âŒ å®šæ—¶ä»»åŠ¡æ‰§è¡Œå¤±è´¥:', error);
    }
  }
};
```

### åŒæ­¥å¤„ç†å™¨

**æ–‡ä»¶**: `backend/src/handlers/questionnaire2SyncHandler.ts`

**æ ¸å¿ƒç±»**: `Questionnaire2SyncHandler`

**ä¸»è¦æ–¹æ³•**:

#### executeFullSync()

**åŠŸèƒ½**: æ‰§è¡Œå®Œæ•´çš„æ•°æ®åŒæ­¥

**è¿”å›**:
```typescript
{
  success: boolean;
  syncedTables: string[];
  totalRecords: number;
  errors: string[];
}
```

**æµç¨‹**:
1. è¯»å–æ‰€æœ‰é—®å·2æ•°æ®
2. è§£æJSON
3. ç»Ÿè®¡èšåˆ
4. åŒæ­¥åˆ°6ä¸ªé™æ€è¡¨
5. è®°å½•æ—¥å¿—

#### parseResponses()

**åŠŸèƒ½**: è§£æå“åº”æ•°æ®å¹¶ç”Ÿæˆç»Ÿè®¡

**å‚æ•°**: `responses: any[]`

**è¿”å›**: ç»Ÿè®¡å¯¹è±¡

**å®ç°**:
```typescript
private parseResponses(responses: any[]) {
  const stats = {
    total: responses.length,
    gender: {},
    ageRange: {},
    // ... å…¶ä»–ç»´åº¦
  };

  for (const response of responses) {
    const data = JSON.parse(response.response_data);
    
    for (const section of data.sectionResponses) {
      for (const questionResponse of section.responses) {
        const questionId = questionResponse.questionId;
        const value = questionResponse.value;
        
        // ç»Ÿè®¡èšåˆ
        if (questionId === 'gender-v2') {
          stats.gender[value] = (stats.gender[value] || 0) + 1;
        }
        // ... å…¶ä»–é—®é¢˜
      }
    }
  }

  return stats;
}
```

---

## éƒ¨ç½²é…ç½®

### åç«¯éƒ¨ç½²

**å¹³å°**: Cloudflare Workers

**éƒ¨ç½²å‘½ä»¤**:
```bash
cd backend
pnpm run deploy
```

**é…ç½®æ–‡ä»¶**: `backend/wrangler.toml`

**å…³é”®é…ç½®**:
```toml
name = "employment-survey-api-prod"
main = "src/index.ts"
compatibility_date = "2024-01-01"

[[d1_databases]]
binding = "DB"
database_name = "college-employment-survey"
database_id = "25eee5bd-9aee-439a-8723-c73bf5f4f3d9"

[triggers]
crons = ["*/30 * * * *"]
```

**éƒ¨ç½²URL**: `https://employment-survey-api-prod.chrismarker89.workers.dev`

### å‰ç«¯éƒ¨ç½²

**å¹³å°**: Cloudflare Pages

**éƒ¨ç½²å‘½ä»¤**:
```bash
cd frontend
pnpm run build
npx wrangler pages deploy dist --project-name=college-employment-survey-frontend
```

**æ„å»ºé…ç½®**: `frontend/vite.config.ts`

**éƒ¨ç½²URL**: `https://college-employment-survey-frontend-l84.pages.dev`

**è®¿é—®è·¯å¾„**: `/analytics/v3`

---

## æ€§èƒ½ä¼˜åŒ–

### 1. å‰ç«¯ä¼˜åŒ–

#### æ•°æ®ç¼“å­˜
- **ç­–ç•¥**: 5åˆ†é’ŸTTLå†…å­˜ç¼“å­˜
- **å®ç°**: `questionnaire2DataService`
- **æ•ˆæœ**: å‡å°‘APIè°ƒç”¨ï¼Œæå‡å“åº”é€Ÿåº¦

#### ä»£ç åˆ†å‰²
- **å·¥å…·**: ViteåŠ¨æ€å¯¼å…¥
- **å®ç°**: React.lazy + Suspense
- **æ•ˆæœ**: å‡å°åˆå§‹åŠ è½½ä½“ç§¯

#### å›¾è¡¨æ‡’åŠ è½½
- **å·¥å…·**: Intersection Observer
- **å®ç°**: ä»…æ¸²æŸ“å¯è§å›¾è¡¨
- **æ•ˆæœ**: æå‡é¦–å±åŠ è½½é€Ÿåº¦

### 2. åç«¯ä¼˜åŒ–

#### æ•°æ®åº“ç´¢å¼•
- **è¡¨**: æ‰€æœ‰é™æ€è¡¨
- **å­—æ®µ**: dimension, value, updated_at
- **æ•ˆæœ**: åŠ å¿«æŸ¥è¯¢é€Ÿåº¦

#### æ‰¹é‡æ“ä½œ
- **æ–¹æ³•**: D1 batch API
- **åœºæ™¯**: æ•°æ®åŒæ­¥æ—¶æ‰¹é‡æ’å…¥
- **æ•ˆæœ**: å‡å°‘æ•°æ®åº“å¾€è¿”æ¬¡æ•°

#### å®šæ—¶åŒæ­¥
- **é¢‘ç‡**: æ¯30åˆ†é’Ÿ
- **ä¼˜åŠ¿**: é¿å…å®æ—¶è®¡ç®—ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½

### 3. ç½‘ç»œä¼˜åŒ–

#### CDNåŠ é€Ÿ
- **å¹³å°**: Cloudflareå…¨çƒCDN
- **è¦†ç›–**: å…¨çƒ200+èŠ‚ç‚¹
- **æ•ˆæœ**: é™ä½å»¶è¿Ÿï¼Œæå‡è®¿é—®é€Ÿåº¦

#### Gzipå‹ç¼©
- **å·¥å…·**: Viteè‡ªåŠ¨å‹ç¼©
- **å‹ç¼©ç‡**: çº¦70%
- **æ•ˆæœ**: å‡å°ä¼ è¾“ä½“ç§¯

---

## ç›‘æ§ä¸æ—¥å¿—

### åŒæ­¥æ—¥å¿—

**è¡¨**: `q2_sync_log`

**è®°å½•å†…å®¹**:
- åŒæ­¥ç±»å‹ (manual/scheduled)
- åŒæ­¥çš„è¡¨æ•°é‡
- å¤„ç†çš„è®°å½•æ•°
- çŠ¶æ€ (success/failed)
- é”™è¯¯ä¿¡æ¯
- åŒæ­¥æ—¶é—´

**æŸ¥è¯¢ç¤ºä¾‹**:
```sql
SELECT * FROM q2_sync_log 
ORDER BY sync_time DESC 
LIMIT 10;
```

### é”™è¯¯å¤„ç†

#### å‰ç«¯é”™è¯¯å¤„ç†
- APIè°ƒç”¨å¤±è´¥ â†’ ä½¿ç”¨ç¼“å­˜æˆ–æ˜¾ç¤ºé”™è¯¯æç¤º
- æ•°æ®è§£æå¤±è´¥ â†’ è®°å½•é”™è¯¯å¹¶è·³è¿‡è¯¥æ¡è®°å½•
- å›¾è¡¨æ¸²æŸ“å¤±è´¥ â†’ æ˜¾ç¤ºå ä½ç¬¦

#### åç«¯é”™è¯¯å¤„ç†
- æ•°æ®åº“è¿æ¥å¤±è´¥ â†’ è¿”å›500é”™è¯¯
- æ•°æ®è§£æå¤±è´¥ â†’ è®°å½•é”™è¯¯å¹¶ç»§ç»­å¤„ç†å…¶ä»–è®°å½•
- åŒæ­¥å¤±è´¥ â†’ è®°å½•åˆ°sync_logè¡¨

---

## ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤

#### 1. æ£€æŸ¥åŒæ­¥çŠ¶æ€
```sql
SELECT * FROM q2_sync_log 
WHERE status = 'failed' 
ORDER BY sync_time DESC;
```

#### 2. æ‰‹åŠ¨è§¦å‘åŒæ­¥
```bash
curl -X POST https://employment-survey-api-prod.chrismarker89.workers.dev/api/questionnaire-v2/sync-full
```

#### 3. æ¸…ç†æ—§æ•°æ®
```sql
DELETE FROM q2_sync_log 
WHERE sync_time < datetime('now', '-30 days');
```

### æ•…éšœæ’æŸ¥

#### é—®é¢˜1: æ•°æ®ä¸æ›´æ–°
**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥å®šæ—¶ä»»åŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. æŸ¥çœ‹sync_logè¡¨çš„æœ€æ–°è®°å½•
3. æ‰‹åŠ¨è§¦å‘åŒæ­¥æµ‹è¯•
4. æ£€æŸ¥æ•°æ®åº“è¿æ¥

#### é—®é¢˜2: å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸
**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. éªŒè¯APIè¿”å›æ•°æ®æ ¼å¼
3. æ£€æŸ¥æ•°æ®å¤„ç†é€»è¾‘
4. æ¸…é™¤ç¼“å­˜é‡æ–°åŠ è½½

#### é—®é¢˜3: æ€§èƒ½ä¸‹é™
**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æ•°æ®é‡å¢é•¿æƒ…å†µ
2. åˆ†ææ…¢æŸ¥è¯¢
3. ä¼˜åŒ–æ•°æ®åº“ç´¢å¼•
4. è€ƒè™‘å¢åŠ ç¼“å­˜æ—¶é—´

---

## ä¸ƒç»´åº¦è¯¦ç»†è¯´æ˜

### ç»´åº¦1ï¼šäººå£ç»“æ„ä¸å°±ä¸šç”»åƒ

**Tab Key**: `demographics`

**åŒ…å«å›¾è¡¨**: 6ä¸ª

#### 1.1 æ€§åˆ«åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `gender-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: ç”·/å¥³/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…æ€§åˆ«åˆ†å¸ƒ

#### 1.2 å¹´é¾„åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `age-range-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: 20-22, 23-25, 26-28, 29-35, 35+
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…å¹´é¾„æ®µåˆ†å¸ƒ

#### 1.3 å­¦å†åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `education-level-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: é«˜ä¸­/å¤§ä¸“/æœ¬ç§‘/ç¡•å£«/åšå£«
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…å­¦å†ç»“æ„

#### 1.4 å©šå§»çŠ¶å†µåˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `marital-status-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: å•èº«/å·²å©š/ç¦»å¼‚
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…å©šå§»çŠ¶å†µ

#### 1.5 åŸå¸‚å±‚çº§åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `current-city-tier-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: ä¸€çº¿/äºŒçº¿/ä¸‰çº¿/å››çº¿
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…æ‰€åœ¨åŸå¸‚å±‚çº§

#### 1.6 æˆ·ç±ç±»å‹åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `hukou-type-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: åŸé•‡/å†œæ‘
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…æˆ·ç±ç±»å‹

---

### ç»´åº¦2ï¼šç»æµå‹åŠ›ä¸ç”Ÿæ´»æˆæœ¬

**Tab Key**: `economic`

**åŒ…å«å›¾è¡¨**: 6ä¸ª

#### 2.1 è´Ÿå€ºæƒ…å†µåˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `debt-situation-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: æ— è´Ÿå€º/å­¦ç”Ÿè´·æ¬¾/æˆ¿è´·/è½¦è´·/ä¿¡ç”¨å¡/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…è´Ÿå€ºç±»å‹åˆ†å¸ƒ

#### 2.2 æ¯æœˆç”Ÿæ´»å¼€æ”¯åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `monthly-living-cost-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: <1000, 1000-2000, 2000-3000, 3000-5000, 5000-8000, >8000
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…æœˆåº¦ç”Ÿæ´»æˆæœ¬

#### 2.3 æ”¶å…¥æ¥æºåˆ†å¸ƒï¼ˆå¤šé€‰æŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `income-sources-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: å·¥èµ„/å…¼èŒ/çˆ¶æ¯æ”¯æ´/å¥–å­¦é‡‘/æŠ•èµ„/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…æ”¶å…¥æ¥æºæ„æˆ

#### 2.4 çˆ¶æ¯æ”¯æ´é‡‘é¢åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `parental-support-amount-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: æ— /<1000, 1000-2000, 2000-3000, >3000
- **ç”¨é€”**: å±•ç¤ºçˆ¶æ¯ç»æµæ”¯æ´æƒ…å†µ

#### 2.5 æ”¶æ”¯å¹³è¡¡çŠ¶å†µï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `income-expense-balance-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: å…¥ä¸æ•·å‡º/åŸºæœ¬æŒå¹³/ç•¥æœ‰ç»“ä½™/ç»“ä½™è¾ƒå¤š
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…æ”¶æ”¯å¹³è¡¡çŠ¶æ€

#### 2.6 ç»æµå‹åŠ›ç¨‹åº¦ï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `economic-pressure-level-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: æ— å‹åŠ›/è½»åº¦/ä¸­åº¦/é‡åº¦/æé‡
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…ç»æµå‹åŠ›æ„Ÿå—

---

### ç»´åº¦3ï¼šå°±ä¸šçŠ¶æ€ä¸æ”¶å…¥æ°´å¹³

**Tab Key**: `employment`

**åŒ…å«å›¾è¡¨**: 2ä¸ª

#### 3.1 å°±ä¸šçŠ¶æ€åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `current-status-question-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: åœ¨èŒ/æ±‚èŒä¸­/å¾…ä¸š/åœ¨æ ¡/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…å°±ä¸šçŠ¶æ€

#### 3.2 æœˆè–ªåˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `current-salary-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: <3000, 3000-5000, 5000-8000, 8000-12000, >12000
- **ç”¨é€”**: å±•ç¤ºåœ¨èŒäººå‘˜è–ªèµ„æ°´å¹³

---

### ç»´åº¦4ï¼šæ±‚èŒæ­§è§†ä¸å…¬å¹³æ€§

**Tab Key**: `discrimination`

**åŒ…å«å›¾è¡¨**: 3ä¸ª

#### 4.1 æ­§è§†ç±»å‹åˆ†å¸ƒï¼ˆå¤šé€‰æŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `experienced-discrimination-types-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: æ€§åˆ«/å¹´é¾„/å­¦å†/å©šè‚²/åœ°åŸŸ/å¤–è²Œ/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…é­é‡çš„æ­§è§†ç±»å‹

#### 4.2 æ­§è§†ä¸¥é‡ç¨‹åº¦ï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `discrimination-severity-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: è½»å¾®/ä¸­ç­‰/ä¸¥é‡/éå¸¸ä¸¥é‡
- **ç”¨é€”**: å±•ç¤ºæ­§è§†ä¸¥é‡ç¨‹åº¦æ„Ÿå—

#### 4.3 æ­§è§†å‘ç”Ÿæ¸ é“ï¼ˆå¤šé€‰æŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `discrimination-channels-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: æ‹›è˜å¹¿å‘Š/ç®€å†ç­›é€‰/é¢è¯•/èƒŒæ™¯è°ƒæŸ¥/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºæ­§è§†å‘ç”Ÿçš„ç¯èŠ‚

---

### ç»´åº¦5ï¼šå°±ä¸šä¿¡å¿ƒä¸æœªæ¥é¢„æœŸ

**Tab Key**: `confidence`

**åŒ…å«å›¾è¡¨**: 2ä¸ª

#### 5.1 å°±ä¸šä¿¡å¿ƒæŒ‡æ•°åˆ†å¸ƒï¼ˆæŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `employment-confidence-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: 1-5åˆ†
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…å°±ä¸šä¿¡å¿ƒæ°´å¹³

#### 5.2 ä¿¡å¿ƒå½±å“å› ç´ ï¼ˆå¤šé€‰æŸ±çŠ¶å›¾ï¼‰
- **æ•°æ®æº**: `confidence-factors-v2`
- **å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾
- **æ•°æ®é¡¹**: å¸‚åœºç«äº‰/æŠ€èƒ½ä¸åŒ¹é…/å¹´é¾„é™åˆ¶/å­¦å†è¦æ±‚/ç»éªŒä¸è¶³/å…¶ä»–
- **ç”¨é€”**: å±•ç¤ºå½±å“å°±ä¸šä¿¡å¿ƒçš„ä¸»è¦å› ç´ 

---

### ç»´åº¦6ï¼šç”Ÿè‚²æ„æ„¿ä¸å©šè‚²å‹åŠ›

**Tab Key**: `fertility`

**åŒ…å«å›¾è¡¨**: 1ä¸ª

#### 6.1 ç”Ÿè‚²è®¡åˆ’åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
- **æ•°æ®æº**: `fertility-intent-v2`
- **å›¾è¡¨ç±»å‹**: é¥¼å›¾
- **æ•°æ®é¡¹**: è®¡åˆ’ç”Ÿè‚²/æš‚ä¸è€ƒè™‘/ä¸æ‰“ç®—ç”Ÿè‚²/æœªå†³å®š
- **ç”¨é€”**: å±•ç¤ºå‚ä¸è€…ç”Ÿè‚²æ„æ„¿

---

### ç»´åº¦7ï¼šäº¤å‰åˆ†æä¸æ´å¯Ÿ

**Tab Key**: `cross`

**åŒ…å«å†…å®¹**: æ ¸å¿ƒæ´å¯Ÿå¡ç‰‡ + å…³é”®å‘ç°

#### 7.1 æ ¸å¿ƒæ´å¯Ÿå¡ç‰‡
- å¹³å‡å°±ä¸šä¿¡å¿ƒæŒ‡æ•°
- ç»æµå‹åŠ›äººç¾¤å æ¯”
- é­é‡æ­§è§†äººç¾¤å æ¯”
- ç”Ÿè‚²æ„æ„¿æ¯”ä¾‹

#### 7.2 å…³é”®å‘ç°
- å­¦å†ä¸æ”¶å…¥çš„ç›¸å…³æ€§
- ç»æµå‹åŠ›å¯¹ç”Ÿè‚²æ„æ„¿çš„å½±å“
- å¹´é¾„ä¸æ­§è§†ç»å†çš„å…³ç³»
- å°±ä¸šçŠ¶æ€å¯¹ä¿¡å¿ƒæŒ‡æ•°çš„å½±å“

---

## å¿«é€Ÿå¼€å§‹æŒ‡å—

### æœ¬åœ°å¼€å‘

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd jiuye-V1
```

#### 2. å®‰è£…ä¾èµ–
```bash
# åç«¯
cd backend
pnpm install

# å‰ç«¯
cd ../frontend
pnpm install
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡
```bash
# backend/.dev.vars
DB=<your-d1-database>
JWT_SECRET=<your-jwt-secret>
```

#### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
# åç«¯
cd backend
pnpm run dev

# å‰ç«¯
cd frontend
pnpm run dev
```

#### 5. è®¿é—®åº”ç”¨
- å‰ç«¯: http://localhost:5173/analytics/v3
- åç«¯: http://localhost:8787

---

### ç”Ÿäº§éƒ¨ç½²

#### 1. éƒ¨ç½²åç«¯
```bash
cd backend
pnpm run deploy
```

#### 2. éƒ¨ç½²å‰ç«¯
```bash
cd frontend
pnpm run build
npx wrangler pages deploy dist --project-name=college-employment-survey-frontend
```

#### 3. éªŒè¯éƒ¨ç½²
- è®¿é—®: https://college-employment-survey-frontend-l84.pages.dev/analytics/v3
- æ£€æŸ¥æ•°æ®åŠ è½½æ˜¯å¦æ­£å¸¸
- æµ‹è¯•æ‰€æœ‰å›¾è¡¨æ˜¯å¦æ˜¾ç¤º

---

## å¸¸è§é—®é¢˜ (FAQ)

### Q1: æ•°æ®ä¸æ›´æ–°æ€ä¹ˆåŠï¼Ÿ

**A**:
1. æ£€æŸ¥å®šæ—¶ä»»åŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. æ‰‹åŠ¨è§¦å‘åŒæ­¥: `POST /api/questionnaire-v2/sync-full`
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
4. æ£€æŸ¥APIæ˜¯å¦æ­£å¸¸å“åº”

### Q2: å›¾è¡¨æ˜¾ç¤ºç©ºç™½æ€ä¹ˆåŠï¼Ÿ

**A**:
1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹é”™è¯¯
2. æ£€æŸ¥APIè¿”å›æ•°æ®æ ¼å¼
3. éªŒè¯æ•°æ®å¤„ç†é€»è¾‘
4. ç¡®è®¤UniversalChartç»„ä»¶æ­£å¸¸åŠ è½½

### Q3: å¦‚ä½•æ·»åŠ æ–°çš„ç»´åº¦ï¼Ÿ

**A**:
1. åœ¨é—®å·å®šä¹‰ä¸­æ·»åŠ æ–°é—®é¢˜
2. æ›´æ–°æ•°æ®æœåŠ¡çš„ç»Ÿè®¡é€»è¾‘
3. åœ¨é¡µé¢ç»„ä»¶ä¸­æ·»åŠ æ–°Tab
4. åˆ›å»ºå¯¹åº”çš„å›¾è¡¨ç»„ä»¶
5. æ›´æ–°ç±»å‹å®šä¹‰

### Q4: å¦‚ä½•ä¿®æ”¹å®šæ—¶åŒæ­¥é¢‘ç‡ï¼Ÿ

**A**:
1. ç¼–è¾‘`backend/wrangler.toml`
2. ä¿®æ”¹`crons`é…ç½®
3. é‡æ–°éƒ¨ç½²åç«¯
4. éªŒè¯æ–°çš„åŒæ­¥é¢‘ç‡

### Q5: å¦‚ä½•å¯¼å‡ºæ•°æ®ï¼Ÿ

**A**:
1. ä½¿ç”¨wrangler CLIå¯¼å‡ºD1æ•°æ®åº“
2. æˆ–é€šè¿‡APIè·å–JSONæ ¼å¼æ•°æ®
3. å‰ç«¯å¯æ·»åŠ å¯¼å‡ºåŠŸèƒ½ï¼ˆPDF/Excelï¼‰

---

## é™„å½•

### A. é—®å·2å®Œæ•´é—®é¢˜åˆ—è¡¨

#### åŸºç¡€ä¿¡æ¯ (8é¢˜)
1. gender-v2: æ€§åˆ«
2. age-range-v2: å¹´é¾„æ®µ
3. education-level-v2: å­¦å†
4. marital-status-v2: å©šå§»çŠ¶å†µ
5. current-city-tier-v2: åŸå¸‚å±‚çº§
6. hukou-type-v2: æˆ·ç±ç±»å‹
7. current-province-v2: å½“å‰çœä»½
8. hometown-province-v2: å®¶ä¹¡çœä»½

#### å½“å‰çŠ¶æ€ (1é¢˜)
9. current-status-question-v2: å°±ä¸šçŠ¶æ€

#### ç»æµå‹åŠ› (7é¢˜)
10. debt-situation-v2: è´Ÿå€ºæƒ…å†µ
11. monthly-living-cost-v2: æœˆåº¦ç”Ÿæ´»å¼€æ”¯
12. income-sources-v2: æ”¶å…¥æ¥æº
13. parental-support-amount-v2: çˆ¶æ¯æ”¯æ´é‡‘é¢
14. income-expense-balance-v2: æ”¶æ”¯å¹³è¡¡
15. economic-pressure-level-v2: ç»æµå‹åŠ›ç¨‹åº¦
16. economic-pressure-sources-v2: ç»æµå‹åŠ›æ¥æº

#### å°±ä¸šä¿¡å¿ƒ (2é¢˜)
17. employment-confidence-v2: å°±ä¸šä¿¡å¿ƒæŒ‡æ•°
18. confidence-factors-v2: ä¿¡å¿ƒå½±å“å› ç´ 

#### æ±‚èŒæ­§è§† (3é¢˜)
19. experienced-discrimination-types-v2: æ­§è§†ç±»å‹
20. discrimination-severity-v2: æ­§è§†ä¸¥é‡ç¨‹åº¦
21. discrimination-channels-v2: æ­§è§†å‘ç”Ÿæ¸ é“

#### æ¡ä»¶åˆ†æ”¯é—®é¢˜ (çº¦20é¢˜)
- åœ¨èŒäººå‘˜: è–ªèµ„ã€å·¥ä½œæ—¶é•¿ã€æ»¡æ„åº¦ç­‰
- æ±‚èŒäººå‘˜: æ±‚èŒæ—¶é•¿ã€æœŸæœ›è–ªèµ„ã€å›°éš¾ç­‰
- å­¦ç”Ÿ: ä¸“ä¸šã€å®ä¹ ç»å†ã€å°±ä¸šå‡†å¤‡ç­‰
- å¥³æ€§: ç”Ÿè‚²è®¡åˆ’ã€å©šè‚²å‹åŠ›ç­‰

**æ€»è®¡**: çº¦40é¢˜

---

### B. æŠ€æœ¯æ ˆç‰ˆæœ¬æ¸…å•

#### å‰ç«¯
- React: 18.3.1
- TypeScript: 5.x
- Ant Design: 5.26.6
- ECharts: 5.6.0
- React Router: 6.30.1
- Framer Motion: 11.x
- Vite: 5.4.19

#### åç«¯
- Hono: 4.x
- TypeScript: 5.x
- Wrangler: 4.40.2
- Cloudflare Workers Runtime: Latest
- Cloudflare D1: Latest

---

### C. ç›¸å…³é“¾æ¥

- **ç”Ÿäº§ç¯å¢ƒå‰ç«¯**: https://college-employment-survey-frontend-l84.pages.dev/analytics/v3
- **ç”Ÿäº§ç¯å¢ƒåç«¯**: https://employment-survey-api-prod.chrismarker89.workers.dev
- **Cloudflare Dashboard**: https://dash.cloudflare.com
- **é¡¹ç›®æ–‡æ¡£**: è§é¡¹ç›®æ ¹ç›®å½•çš„Markdownæ–‡ä»¶

---

### D. æ›´æ–°æ—¥å¿—

#### v1.0 (2025-01-05)
- âœ… å®Œæˆä¸ƒç»´åº¦å¯è§†åŒ–ç³»ç»Ÿ
- âœ… å®ç°1000æ¡æµ‹è¯•æ•°æ®å¯¼å…¥
- âœ… é…ç½®å®šæ—¶åŒæ­¥ä»»åŠ¡
- âœ… ç¦ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œå¼ºåˆ¶ä½¿ç”¨çœŸå®API
- âœ… å®Œæˆå®Œæ•´æŠ€æœ¯æ–‡æ¡£

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-01-05
**ç»´æŠ¤äºº**: Augment Agent
**çŠ¶æ€**: ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­
**æ€»é¡µæ•°**: çº¦50é¡µ
**æ€»å­—æ•°**: çº¦15000å­—

