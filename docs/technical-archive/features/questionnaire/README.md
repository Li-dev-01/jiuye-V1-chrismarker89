# ğŸ“ é—®å·ç³»ç»ŸåŠŸèƒ½æ–‡æ¡£

> **æ¨¡å—**: é—®å·è°ƒç ”ä¸æ•°æ®æ”¶é›†  
> **å®Œæˆåº¦**: 100%  
> **æœ€åæ›´æ–°**: 2025å¹´10æœˆ7æ—¥

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

### åŸºæœ¬ä¿¡æ¯
- **æ¨¡å—åç§°**: åŒé—®å·ç³»ç»Ÿï¼ˆV1 + V2ï¼‰
- **è´Ÿè´£èŒƒå›´**: é—®å·å¡«å†™ã€æ•°æ®æ”¶é›†ã€è¿›åº¦ä¿å­˜ã€æ•°æ®å¯è§†åŒ–
- **æŠ€æœ¯æ ˆ**: React + TypeScript + D1 + ECharts
- **ä¾èµ–æ¨¡å—**: è®¤è¯ç³»ç»Ÿã€æ•°æ®åˆ†æç³»ç»Ÿ

### ç³»ç»Ÿæ¶æ„
é—®å·ç³»ç»Ÿé‡‡ç”¨**åŒç³»ç»Ÿå¹¶è¡Œæ¶æ„**ï¼š

```
é—®å·ç³»ç»Ÿ
â”œâ”€â”€ V1ä¼ ç»Ÿé—®å·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ åŸºç¡€å°±ä¸šä¿¡æ¯æ”¶é›†
â”‚   â”œâ”€â”€ ä¼ ç»ŸåµŒå¥—æ•°æ®æ ¼å¼
â”‚   â””â”€â”€ questionnaire_responsesè¡¨
â”‚
â””â”€â”€ V2æ™ºèƒ½é—®å·ç³»ç»Ÿ
    â”œâ”€â”€ ç»æµå‹åŠ›åˆ†æ
    â”œâ”€â”€ å°±ä¸šä¿¡å¿ƒæŒ‡æ•°
    â”œâ”€â”€ æ™ºèƒ½åˆ†æ”¯é€»è¾‘
    â”œâ”€â”€ å®æ—¶ç»Ÿè®¡
    â””â”€â”€ universal_questionnaire_responsesè¡¨
```

---

## ğŸ¯ åŠŸèƒ½æ¸…å•

### 1. é—®å·å¡«å†™ï¼ˆV1ä¼ ç»Ÿé—®å·ï¼‰

#### åŠŸèƒ½ID: QUEST-V1-001
- **è§’è‰²**: æ‰€æœ‰ç”¨æˆ·
- **ç”¨é€”**: å¡«å†™ä¼ ç»Ÿå°±ä¸šè°ƒæŸ¥é—®å·
- **APIç«¯ç‚¹**: 
  - `GET /api/questionnaire-v1/definition/:id` - è·å–é—®å·å®šä¹‰
  - `POST /api/questionnaire-v1/submit` - æäº¤é—®å·
  - `GET /api/questionnaire-v1/responses` - è·å–é—®å·åˆ—è¡¨
  - `GET /api/questionnaire-v1/responses/:id` - è·å–é—®å·è¯¦æƒ…
- **æ•°æ®åº“è¡¨**: 
  - `questionnaire_responses` - V1é—®å·å“åº”è¡¨
- **å‰ç«¯é¡µé¢**: 
  - `/questionnaire` - é—®å·å¡«å†™é¡µ
  - `/my-content` - æˆ‘çš„é—®å·
- **æµ‹è¯•è¦†ç›–**: âœ… å®Œæ•´æµ‹è¯•

#### V1é—®å·ç»“æ„

**æ•°æ®æ ¼å¼**:
```json
{
  "personalInfo": {
    "age": 22,
    "gender": "male",
    "education": "bachelor"
  },
  "educationInfo": {
    "school": "åŒ—äº¬å¤§å­¦",
    "major": "è®¡ç®—æœºç§‘å­¦",
    "graduationYear": 2024
  },
  "employmentInfo": {
    "status": "employed",
    "jobTitle": "è½¯ä»¶å·¥ç¨‹å¸ˆ",
    "salary": "15000"
  },
  "jobSearchInfo": {
    "duration": "3ä¸ªæœˆ",
    "channels": ["æ ¡æ‹›", "å†…æ¨"]
  }
}
```

**ç‰¹ç‚¹**:
- âœ… ä¼ ç»ŸåµŒå¥—JSONæ ¼å¼
- âœ… å›ºå®šé—®é¢˜é¡ºåº
- âœ… ç®€å•éªŒè¯è§„åˆ™
- âœ… é€‚åˆåŸºç¡€ä¿¡æ¯æ”¶é›†

---

### 2. æ™ºèƒ½é—®å·å¡«å†™ï¼ˆV2æ™ºèƒ½é—®å·ï¼‰

#### åŠŸèƒ½ID: QUEST-V2-001
- **è§’è‰²**: æ‰€æœ‰ç”¨æˆ·
- **ç”¨é€”**: å¡«å†™æ™ºèƒ½é—®å·ï¼Œæ”¯æŒåˆ†æ”¯é€»è¾‘
- **APIç«¯ç‚¹**: 
  - `GET /api/questionnaire-v2/definition/:id` - è·å–é—®å·å®šä¹‰
  - `POST /api/questionnaire-v2/submit` - æäº¤é—®å·
  - `GET /api/questionnaire-v2/responses` - è·å–é—®å·åˆ—è¡¨
  - `GET /api/questionnaire-v2/responses/:id` - è·å–é—®å·è¯¦æƒ…
  - `GET /api/questionnaire-v2/analytics/:id` - è·å–å¯è§†åŒ–æ•°æ®
- **æ•°æ®åº“è¡¨**: 
  - `universal_questionnaire_responses` - V2é—®å·å“åº”è¡¨
  - `questionnaire_v2_statistics` - V2ç»Ÿè®¡è¡¨
- **å‰ç«¯é¡µé¢**: 
  - `/questionnaire-v2` - V2é—®å·å¡«å†™é¡µ
  - `/visualization` - æ•°æ®å¯è§†åŒ–é¡µ
- **æµ‹è¯•è¦†ç›–**: âœ… å®Œæ•´æµ‹è¯•

#### V2é—®å·ç‰¹æ€§

**æ™ºèƒ½åˆ†æ”¯é€»è¾‘**:
```typescript
// æ ¹æ®å‰é¢çš„å›ç­”åŠ¨æ€æ˜¾ç¤ºåç»­é—®é¢˜
if (economicPressure > 3) {
  showQuestion('debt-details');
  showQuestion('financial-support');
}

if (employmentStatus === 'unemployed') {
  showQuestion('job-search-duration');
  showQuestion('job-search-challenges');
}
```

**æ•°æ®æ ¼å¼**:
```json
{
  "sectionResponses": [
    {
      "sectionId": "economic-pressure",
      "responses": [
        {
          "questionId": "monthly-income",
          "answer": "5000-8000"
        },
        {
          "questionId": "debt-burden",
          "answer": "moderate"
        }
      ]
    },
    {
      "sectionId": "employment-confidence",
      "responses": [
        {
          "questionId": "short-term-confidence",
          "answer": 4
        }
      ]
    }
  ],
  "metadata": {
    "completionTime": 180,
    "deviceType": "mobile",
    "tags": ["ç»æµå‹åŠ›å¤§", "å°±ä¸šä¿¡å¿ƒä¸­ç­‰"]
  }
}
```

**æ ¸å¿ƒç»´åº¦**:
1. **ç»æµå‹åŠ›åˆ†æ** - æ”¶å…¥ã€æ”¯å‡ºã€è´Ÿå€ºæƒ…å†µ
2. **å°±ä¸šä¿¡å¿ƒæŒ‡æ•°** - çŸ­æœŸ/é•¿æœŸå°±ä¸šä¿¡å¿ƒ
3. **ç°ä»£è´Ÿå€ºå½¢å¼** - å­¦ç”Ÿè´·æ¬¾ã€ä¿¡ç”¨å¡ã€ç½‘è´·ç­‰
4. **ç”Ÿæ´»æ€åº¦** - æ¶ˆè´¹è§‚å¿µã€èŒä¸šè§„åˆ’

---

### 3. é—®å·è¿›åº¦ä¿å­˜

#### åŠŸèƒ½ID: QUEST-003
- **è§’è‰²**: å·²ç™»å½•ç”¨æˆ·
- **ç”¨é€”**: ä¿å­˜æœªå®Œæˆçš„é—®å·è¿›åº¦
- **APIç«¯ç‚¹**: 
  - `POST /api/questionnaire/save-progress` - ä¿å­˜è¿›åº¦
  - `GET /api/questionnaire/progress/:id` - è·å–è¿›åº¦
  - `DELETE /api/questionnaire/progress/:id` - åˆ é™¤è¿›åº¦
- **æ•°æ®åº“è¡¨**: 
  - `questionnaire_progress` - è¿›åº¦ä¿å­˜è¡¨
- **å‰ç«¯é¡µé¢**: 
  - `/questionnaire` - é—®å·å¡«å†™é¡µï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰
- **æµ‹è¯•è¦†ç›–**: âœ… å®Œæ•´æµ‹è¯•

#### è‡ªåŠ¨ä¿å­˜æœºåˆ¶

**ä¿å­˜æ—¶æœº**:
- æ¯å®Œæˆä¸€ä¸ªsectionè‡ªåŠ¨ä¿å­˜
- ç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»"ä¿å­˜è‰ç¨¿"
- é¡µé¢å…³é—­å‰è‡ªåŠ¨ä¿å­˜

**æ•°æ®ç»“æ„**:
```json
{
  "userId": "uuid_xxx",
  "questionnaireId": "questionnaire-v2-2024",
  "currentSection": 2,
  "currentResponses": {
    "section1": {...},
    "section2": {...}
  },
  "lastSavedAt": "2025-10-07T10:00:00Z"
}
```

---

### 4. é—®å·æ•°æ®æŸ¥çœ‹

#### åŠŸèƒ½ID: QUEST-004
- **è§’è‰²**: å·²ç™»å½•ç”¨æˆ·
- **ç”¨é€”**: æŸ¥çœ‹è‡ªå·±æäº¤çš„é—®å·
- **APIç«¯ç‚¹**: 
  - `GET /api/questionnaire/my-submissions` - æˆ‘çš„é—®å·åˆ—è¡¨
  - `GET /api/questionnaire/submission/:id` - é—®å·è¯¦æƒ…
- **æ•°æ®åº“è¡¨**: 
  - `questionnaire_responses` (V1)
  - `universal_questionnaire_responses` (V2)
- **å‰ç«¯é¡µé¢**: 
  - `/my-content` - æˆ‘çš„å†…å®¹é¡µ
- **æµ‹è¯•è¦†ç›–**: âœ… å®Œæ•´æµ‹è¯•

#### æ•°æ®å±•ç¤º

**åˆ—è¡¨è§†å›¾**:
- æäº¤æ—¶é—´
- é—®å·ç±»å‹ï¼ˆV1/V2ï¼‰
- å®ŒæˆçŠ¶æ€
- ç”Ÿæˆçš„æ ‡ç­¾

**è¯¦æƒ…è§†å›¾**:
- æ‰€æœ‰é—®é¢˜å’Œç­”æ¡ˆ
- æäº¤æ—¶é—´
- è®¾å¤‡ä¿¡æ¯
- ç”Ÿæˆçš„ç”¨æˆ·ç”»åƒæ ‡ç­¾

---

### 5. æ•°æ®å¯è§†åŒ–

#### åŠŸèƒ½ID: QUEST-005
- **è§’è‰²**: æ‰€æœ‰ç”¨æˆ·
- **ç”¨é€”**: æŸ¥çœ‹é—®å·ç»Ÿè®¡æ•°æ®å¯è§†åŒ–
- **APIç«¯ç‚¹**: 
  - `GET /api/questionnaire-v2/analytics/:id` - è·å–å¯è§†åŒ–æ•°æ®
  - `GET /api/analytics/visualization` - ç»¼åˆå¯è§†åŒ–
- **æ•°æ®åº“è¡¨**: 
  - `questionnaire_v2_statistics` - ç»Ÿè®¡æ•°æ®è¡¨
- **å‰ç«¯é¡µé¢**: 
  - `/visualization` - æ•°æ®å¯è§†åŒ–é¡µ
- **æµ‹è¯•è¦†ç›–**: âœ… å®Œæ•´æµ‹è¯•
- **ç›¸å…³æ–‡æ¡£**: [å¯è§†åŒ–ä¿®å¤æŠ¥å‘Š](../../../../VISUALIZATION_FIX_REPORT.md)

#### å¯è§†åŒ–å›¾è¡¨

**ç»æµå‹åŠ›åˆ†å¸ƒ**:
```typescript
{
  chartType: 'bar',
  data: {
    labels: ['æ— å‹åŠ›', 'è½»å¾®', 'ä¸­ç­‰', 'è¾ƒå¤§', 'æå¤§'],
    values: [120, 350, 580, 420, 230]
  }
}
```

**å°±ä¸šä¿¡å¿ƒæŒ‡æ•°**:
```typescript
{
  chartType: 'line',
  data: {
    shortTerm: [3.5, 3.8, 4.0, 4.2],
    longTerm: [3.0, 3.2, 3.4, 3.5]
  }
}
```

**ç°ä»£è´Ÿå€ºå½¢å¼**:
```typescript
{
  chartType: 'pie',
  data: {
    'å­¦ç”Ÿè´·æ¬¾': 45%,
    'ä¿¡ç”¨å¡': 30%,
    'ç½‘è´·': 15%,
    'å…¶ä»–': 10%
  }
}
```

---

## ğŸ”— å…±ç”¨ç»„ä»¶

### åç«¯ç»„ä»¶
- `QuestionnaireV1ConfigManager` - V1é…ç½®ç®¡ç†
- `QuestionnaireV2ConfigManager` - V2é…ç½®ç®¡ç†
- `QuestionnaireValidator` - é—®å·éªŒè¯å™¨
- `StatisticsCalculator` - ç»Ÿè®¡è®¡ç®—å™¨

### å‰ç«¯ç»„ä»¶
- `QuestionnaireForm` - é—®å·è¡¨å•ç»„ä»¶
- `ProgressSaver` - è¿›åº¦ä¿å­˜ç»„ä»¶
- `VisualizationChart` - å¯è§†åŒ–å›¾è¡¨ç»„ä»¶
- `QuestionRenderer` - é—®é¢˜æ¸²æŸ“å™¨

---

## ğŸ“Š æ•°æ®æµ

### é—®å·æäº¤æµç¨‹
```
ç”¨æˆ·å¡«å†™é—®å·
  â†“
å‰ç«¯éªŒè¯
  â†“
è‡ªåŠ¨ä¿å­˜è¿›åº¦
  â†“
ç”¨æˆ·æäº¤
  â†“
åç«¯éªŒè¯
  â†“
ç”Ÿæˆç”¨æˆ·æ ‡ç­¾
  â†“
å­˜å‚¨åˆ°æ•°æ®åº“
  â†“
æ›´æ–°ç»Ÿè®¡æ•°æ®
  â†“
è¿”å›æˆåŠŸ
```

### ç»Ÿè®¡æ•°æ®æ›´æ–°æµç¨‹
```
æ–°é—®å·æäº¤
  â†“
æå–å…³é”®ç»´åº¦æ•°æ®
  â†“
æ›´æ–°ç»Ÿè®¡è¡¨
  â†“
é‡æ–°è®¡ç®—èšåˆæ•°æ®
  â†“
ç¼“å­˜å¯è§†åŒ–æ•°æ®
  â†“
å‰ç«¯å®æ—¶åˆ·æ–°
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

- **é—®å·åŠ è½½æ—¶é—´**: < 300ms
- **æäº¤å“åº”æ—¶é—´**: < 500ms
- **è¿›åº¦ä¿å­˜æ—¶é—´**: < 200ms
- **å¯è§†åŒ–åŠ è½½æ—¶é—´**: < 800ms
- **å¹¶å‘æäº¤æ”¯æŒ**: 500+ req/s

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é—®å·è®¾è®¡
- é—®é¢˜æ•°é‡æ§åˆ¶åœ¨20-30ä¸ª
- ä½¿ç”¨åˆ†æ”¯é€»è¾‘å‡å°‘æ— å…³é—®é¢˜
- æä¾›è¿›åº¦æŒ‡ç¤ºå™¨

### 2. æ•°æ®è´¨é‡
- å‰åç«¯åŒé‡éªŒè¯
- å¿…å¡«é¡¹æ˜ç¡®æ ‡æ³¨
- æä¾›ç¤ºä¾‹ç­”æ¡ˆ

### 3. ç”¨æˆ·ä½“éªŒ
- è‡ªåŠ¨ä¿å­˜è¿›åº¦
- æ”¯æŒè¿”å›ä¿®æ”¹
- æäº¤å‰é¢„è§ˆ

### 4. æ€§èƒ½ä¼˜åŒ–
- åˆ†é¡µåŠ è½½é—®é¢˜
- ç»Ÿè®¡æ•°æ®ç¼“å­˜
- å›¾è¡¨æ‡’åŠ è½½

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é—®å·å¢å¼ºæŠ¥å‘Š](../../../../questionnaire-enhancement-report.md)
- [å¯è§†åŒ–ä¿®å¤æŠ¥å‘Š](../../../../VISUALIZATION_FIX_REPORT.md)
- [V1/V2ç³»ç»Ÿå¯¹æ¯”](../../../../QUESTIONNAIRE_V1_V2_COMPARISON.md)
- [APIæ–‡æ¡£](../../api/endpoints/questionnaire.md)
- [æ•°æ®æ¨¡å‹](../../api/schemas/questionnaire.md)

