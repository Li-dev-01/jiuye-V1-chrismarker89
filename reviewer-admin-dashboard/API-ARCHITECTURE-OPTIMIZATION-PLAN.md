# APIæ¶æ„ä¼˜åŒ–ä¸æ•°æ®åº“ç»“æ„å®Œå–„æ–¹æ¡ˆ

**åˆ›å»ºæ—¶é—´**: 2024å¹´9æœˆ24æ—¥  
**é—®é¢˜åˆ†æ**: APIç«¯ç‚¹åˆ’åˆ†ä¸æ¸…æ™° + æ•°æ®åº“ç»“æ„æ˜¾ç¤ºä¸å®Œæ•´  
**è§£å†³ç›®æ ‡**: æ˜ç¡®åŒºåˆ†ç”¨æˆ·ç«¯/ç®¡ç†ç«¯API + å±•ç¤ºå®Œæ•´4å±‚æ•°æ®åº“æ¶æ„

## ğŸ¯ **é—®é¢˜åˆ†æ**

### **é—®é¢˜1: APIç«¯ç‚¹åˆ’åˆ†ä¸æ¸…æ™°**
- âŒ ç¼ºä¹ç”¨æˆ·ç«¯/ç®¡ç†ç«¯æ˜ç¡®æ ‡è¯†
- âŒ é—®å·ç”¨æˆ·APIä¸åå°ç®¡ç†APIæ··åˆ
- âŒ ä¿®æ”¹æ—¶å®¹æ˜“å½±å“é—®å·ç”¨æˆ·åŠŸèƒ½

### **é—®é¢˜2: æ•°æ®åº“ç»“æ„ä¸å®Œæ•´**
- âŒ é¡µé¢åªæ˜¾ç¤º6ä¸ªåŸºç¡€è¡¨
- âŒ å®é™…é¡¹ç›®æœ‰35+ä¸ªè¡¨çš„4å±‚æ¶æ„
- âŒ ç¼ºå°‘æ€§èƒ½ä¼˜åŒ–è¡¨çš„å¯è§†åŒ–

## ğŸš€ **è§£å†³æ–¹æ¡ˆ**

### **æ–¹æ¡ˆ1: APIç«¯ç‚¹é‡æ–°åˆ†ç±»**

#### **ğŸ” ç”¨æˆ·ç«¯API (é—®å·ç”¨æˆ·ä½¿ç”¨)**
```typescript
// æ ¸å¿ƒç”¨æˆ·åŠŸèƒ½ - ä¸å¯è½»æ˜“ä¿®æ”¹
{
  category: 'User Frontend',
  userType: 'questionnaire_user',
  priority: 'critical',
  endpoints: [
    'POST /api/questionnaire/submit',           // é—®å·æäº¤
    'POST /api/heart-voices/submit',            // å¿ƒå£°æäº¤
    'GET /api/universal-questionnaire/statistics', // ç»Ÿè®¡æŸ¥çœ‹
    'GET /api/heart-voices',                    // å¿ƒå£°åˆ—è¡¨
    'GET /api/analytics/dashboard'              // æ•°æ®å±•ç¤º
  ]
}
```

#### **ğŸ› ï¸ ç®¡ç†ç«¯API (åå°è¿è¥ä½¿ç”¨)**
```typescript
// ç®¡ç†åŠŸèƒ½ - å¯ä»¥å®‰å…¨ä¿®æ”¹
{
  category: 'Admin Backend',
  userType: 'admin_manager',
  priority: 'high',
  endpoints: [
    'GET /api/simple-admin/dashboard',          // ç®¡ç†ä»ªè¡¨æ¿
    'GET /api/simple-admin/users',              // ç”¨æˆ·ç®¡ç†
    'GET /api/simple-admin/questionnaires',    // é—®å·ç®¡ç†
    'GET /api/simple-admin/analytics',          // æ•°æ®åˆ†æ
    'POST /api/simple-admin/export'             // æ•°æ®å¯¼å‡º
  ]
}
```

#### **ğŸ‘¥ å®¡æ ¸ç«¯API (å®¡æ ¸å‘˜ä½¿ç”¨)**
```typescript
// å®¡æ ¸åŠŸèƒ½ - ä¸­ç­‰ä¼˜å…ˆçº§
{
  category: 'Reviewer Backend',
  userType: 'reviewer',
  priority: 'medium',
  endpoints: [
    'GET /api/simple-reviewer/pending-reviews', // å¾…å®¡æ ¸åˆ—è¡¨
    'POST /api/simple-reviewer/submit-review',  // æäº¤å®¡æ ¸
    'GET /api/simple-reviewer/stats',           // å®¡æ ¸ç»Ÿè®¡
    'GET /api/simple-reviewer/history'          // å®¡æ ¸å†å²
  ]
}
```

### **æ–¹æ¡ˆ2: å®Œæ•´æ•°æ®åº“ç»“æ„å±•ç¤º**

#### **4å±‚æ•°æ®åº“æ¶æ„**

**ç¬¬1å±‚ - ä¸»æ•°æ®è¡¨ (å†™ä¼˜åŒ–)**
```sql
-- æ ¸å¿ƒä¸šåŠ¡è¡¨
universal_questionnaire_responses    -- é€šç”¨é—®å·å“åº”ä¸»è¡¨
universal_users                     -- ç»Ÿä¸€ç”¨æˆ·è¡¨
questionnaire_submissions_temp       -- é—®å·ä¸´æ—¶å­˜å‚¨è¡¨
stories                             -- ç”¨æˆ·æ•…äº‹è¡¨
audit_records                       -- å®¡æ ¸è®°å½•è¡¨
user_sessions                       -- ç”¨æˆ·ä¼šè¯è¡¨
```

**ç¬¬2å±‚ - ä¸šåŠ¡ä¸“ç”¨è¡¨ (è¯»ä¼˜åŒ–)**
```sql
-- ä¸šåŠ¡åŠŸèƒ½ä¸“ç”¨è¡¨
analytics_responses                  -- åˆ†æä¸“ç”¨å“åº”è¡¨
admin_responses                     -- ç®¡ç†ä¸“ç”¨å“åº”è¡¨
social_insights_data                -- ç¤¾äº¤æ´å¯Ÿæ•°æ®è¡¨
export_responses                    -- å¯¼å‡ºä¸“ç”¨å“åº”è¡¨
reviewer_activity_logs              -- å®¡æ ¸å‘˜æ´»åŠ¨æ—¥å¿—
content_management_logs             -- å†…å®¹ç®¡ç†æ—¥å¿—
```

**ç¬¬3å±‚ - ç»Ÿè®¡ç¼“å­˜è¡¨ (æ€§èƒ½ä¼˜åŒ–)**
```sql
-- ç»Ÿè®¡ä¸ç¼“å­˜è¡¨
realtime_stats                      -- å®æ—¶ç»Ÿè®¡è¡¨
aggregated_stats                    -- èšåˆç»Ÿè®¡è¡¨
questionnaire_core_stats            -- é—®å·æ ¸å¿ƒç»Ÿè®¡
questionnaire_enhanced_stats_cache  -- å¢å¼ºç»Ÿè®¡ç¼“å­˜
user_submission_stats               -- ç”¨æˆ·æäº¤ç»Ÿè®¡
content_similarity_detection        -- å†…å®¹ç›¸ä¼¼åº¦æ£€æµ‹
```

**ç¬¬4å±‚ - è§†å›¾ç¼“å­˜è¡¨ (å±•ç¤ºä¼˜åŒ–)**
```sql
-- è§†å›¾ä¸å±•ç¤ºç¼“å­˜è¡¨
dashboard_cache                     -- ä»ªè¡¨æ¿ç¼“å­˜
enhanced_visualization_cache        -- å¢å¼ºå¯è§†åŒ–ç¼“å­˜
questionnaire_user_paths           -- ç”¨æˆ·è·¯å¾„åˆ†æ
questionnaire_data_quality         -- æ•°æ®è´¨é‡è¡¨
batch_operations                   -- æ‰¹é‡æ“ä½œè®°å½•
content_review_queue               -- å†…å®¹å®¡æ ¸é˜Ÿåˆ—
```

## ğŸ”§ **å®æ–½è®¡åˆ’**

### **é˜¶æ®µ1: APIåˆ†ç±»æ ‡è¯† (ä»Šå¤©)**

1. **æ›´æ–°APIç®¡ç†é¡µé¢**
   - æ·»åŠ `userType`å­—æ®µæ ‡è¯†
   - å¢åŠ é¢œè‰²ç¼–ç åŒºåˆ†
   - æ·»åŠ ä¼˜å…ˆçº§æ ‡è¯†

2. **APIç«¯ç‚¹é‡æ–°åˆ†ç±»**
   - ç”¨æˆ·ç«¯API: ç»¿è‰²æ ‡è¯† ğŸŸ¢
   - ç®¡ç†ç«¯API: è“è‰²æ ‡è¯† ğŸ”µ  
   - å®¡æ ¸ç«¯API: æ©™è‰²æ ‡è¯† ğŸŸ 

### **é˜¶æ®µ2: æ•°æ®åº“ç»“æ„å®Œå–„ (æ˜å¤©)**

1. **æ‰©å±•æ•°æ®åº“ç»“æ„é¡µé¢**
   - æ˜¾ç¤ºå®Œæ•´35+ä¸ªè¡¨
   - æŒ‰4å±‚æ¶æ„åˆ†ç»„
   - æ·»åŠ è¡¨å…³ç³»å›¾

2. **æ€§èƒ½ä¼˜åŒ–è¡¨å¯è§†åŒ–**
   - ç¼“å­˜è¡¨çŠ¶æ€ç›‘æ§
   - åŒæ­¥æœºåˆ¶å±•ç¤º
   - æ€§èƒ½æŒ‡æ ‡æ˜¾ç¤º

### **é˜¶æ®µ3: æ¶æ„æ–‡æ¡£å®Œå–„ (åå¤©)**

1. **APIæ¶æ„æ–‡æ¡£**
   - ç”¨æˆ·ç«¯/ç®¡ç†ç«¯APIæ¸…å•
   - ä¿®æ”¹å½±å“èŒƒå›´è¯´æ˜
   - å®‰å…¨ä¿®æ”¹æŒ‡å—

2. **æ•°æ®åº“æ¶æ„æ–‡æ¡£**
   - 4å±‚ç»“æ„è¯¦ç»†è¯´æ˜
   - è¡¨ä¾èµ–å…³ç³»å›¾
   - æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

## ğŸ“Š **é¢„æœŸæ•ˆæœ**

### **APIç®¡ç†æ”¹å–„**
- âœ… æ¸…æ™°åŒºåˆ†ç”¨æˆ·ç«¯/ç®¡ç†ç«¯API
- âœ… ä¿®æ”¹æ—¶é¿å…å½±å“é—®å·ç”¨æˆ·
- âœ… ç²¾å‡†å®šä½åç«¯åŠŸèƒ½ä¿®æ”¹èŒƒå›´

### **æ•°æ®åº“ç®¡ç†æ”¹å–„**
- âœ… å®Œæ•´å±•ç¤º35+ä¸ªè¡¨ç»“æ„
- âœ… å¯è§†åŒ–4å±‚æ¶æ„è®¾è®¡
- âœ… ç›‘æ§æ€§èƒ½ä¼˜åŒ–æ•ˆæœ

### **å¼€å‘æ•ˆç‡æå‡**
- âœ… é™ä½è¯¯ä¿®é£é™©
- âœ… æé«˜ä¿®æ”¹ç²¾å‡†åº¦
- âœ… ä¼˜åŒ–è¿è¥ç®¡ç†æ•ˆç‡

## ğŸ› ï¸ **æŠ€æœ¯å®ç°**

### **APIåˆ†ç±»å®ç°**
```typescript
interface APIEndpoint {
  id: string;
  method: string;
  path: string;
  description: string;
  category: string;
  userType: 'questionnaire_user' | 'admin_manager' | 'reviewer' | 'all';
  priority: 'critical' | 'high' | 'medium' | 'low';
  safeToModify: boolean;
  impactScope: string[];
  // ... å…¶ä»–å­—æ®µ
}
```

### **æ•°æ®åº“ç»“æ„å®ç°**
```typescript
interface DatabaseTable {
  name: string;
  tier: 1 | 2 | 3 | 4;
  tierName: 'Main' | 'Business' | 'Cache' | 'View';
  purpose: 'write' | 'read' | 'cache' | 'display';
  optimization: string[];
  // ... å…¶ä»–å­—æ®µ
}
```

## ğŸ“ˆ **ä¸šåŠ¡ä»·å€¼**

### **é£é™©æ§åˆ¶**
- ğŸ›¡ï¸ é¿å…è¯¯ä¿®ç”¨æˆ·ç«¯API
- ğŸ›¡ï¸ ä¿æŠ¤é—®å·ç”¨æˆ·ä½“éªŒ
- ğŸ›¡ï¸ é™ä½ç³»ç»Ÿæ•…éšœé£é™©

### **è¿è¥æ•ˆç‡**
- ğŸš€ ç²¾å‡†å®šä½ä¿®æ”¹èŒƒå›´
- ğŸš€ å¿«é€Ÿè¯†åˆ«å½±å“èŒƒå›´
- ğŸš€ ä¼˜åŒ–å¼€å‘æµç¨‹

### **ç³»ç»Ÿç¨³å®šæ€§**
- ğŸ“Š å®Œæ•´ç›‘æ§æ•°æ®åº“æ€§èƒ½
- ğŸ“Š å¯è§†åŒ–æ¶æ„å¥åº·çŠ¶æ€
- ğŸ“Š é¢„é˜²æ€§èƒ½ç“¶é¢ˆ

---

**ğŸ¯ ä¸‹ä¸€æ­¥**: ç«‹å³å¼€å§‹å®æ–½APIåˆ†ç±»æ ‡è¯†ï¼Œç¡®ä¿é¡¹ç›®åå°æ•°æ®ä¸ç»“æ„æ¢³ç†å·¥ä½œçš„å®‰å…¨æ€§å’Œç²¾å‡†æ€§ã€‚
